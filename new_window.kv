#:kivy 2.1.0
# include directive includes the contents of another .kv file
#: include ProblemCards.kv

# write screens here 
WindowManager:
    LevelWindow:
    Elementary:
    MiddleSchool:
    HighSchool:
    College:
    ProblemCards:

<LevelWindow>:
    # making the choose your level screen 
    name: "mathLevel"

    # making four buttons 
    BoxLayout:
        orientation: "vertical"
        padding: "30dp"
        spacing: "10dp"
        size: root.width, root.height

        BoxLayout:
            size_hint: (1, 0.5)
            spacing: "150dp"

            # added a back button go back to home screen (note: topic screen would be more reasonable)
            Button:
                text: "Go Back"
                pos_hint: {'left': 1, 'top': 1}
                size_hint: (0.35,0.40)
                font_size: 14
                on_release: 
                    app.root.current = "homeScreen"
                    root.manager.transition.direction = "right"
                    root.play_button_sound()
            
            Toggle:
                pos_hint: {'right': 1, 'top': 1}
                size_hint: (0.5, 0.5)
                on_release:
                    app.toggleMusic()
                Image:
                    id: volume
                    source: 'volume.png'
                    y: self.parent.y
                    x: self.parent.x
                    size: self.parent.size
                    keep_ratio: True

        Label:
            markup: True
            text: "[b]Choose Your Level[/b]"
            halign: 'center'
            valign: 'center'
            color: (0,0,0,1)
            size_hint: (1,0.2)
            font_size: 30
        
        BoxLayout:
            orientation: "horizontal"
            spacing: "10dp"
    
            RoundedButton:
                text: "Elementary\nMath"
                font_size: 20
                halign: 'center'
                valign: 'center'
                # click on button and it will change to a new screen
                on_release:
                    app.root.current = "elementary"
                    root.manager.transition.direction = "left"
                    root.play_button_sound()

            RoundedButton:
                text: "Middle School\nMath"
                font_size: 20
                halign: 'center'
                valign: 'center'
                on_release:
                    app.root.current = "middleSchool"
                    root.manager.transition.direction = "left"
                    root.play_button_sound()

        BoxLayout:
            orientation: "horizontal"
            spacing: "10dp"
    
            RoundedButton:
                text: "High School\nMath"
                font_size: 20
                halign: 'center'
                valign: 'center'
                on_release:
                    app.root.current = "highSchool"
                    root.manager.transition.direction = "left"
                    root.play_button_sound()

            RoundedButton:
                text: "College\nMath"
                font_size: 20
                halign: 'center'
                valign: 'center'
                on_release:
                    app.root.current = "college"
                    root.manager.transition.direction = "left"
                    root.play_button_sound()

# making rounded buttons for the levels of Math
<RoundedButton@Button>
    background_color:(0,0,0,0)
    background_normal: ''
    # canvas is a container for instructions. Use canvas.before to add instructions rendered before with self. 
    canvas.before:
        Color:
            rgba: (25/255,44/255,132/255,1)
        RoundedRectangle:
            size: self.size
            pos: self.pos
            # change radius to change roundness of the button
            radius: [28]

# making rounded buttons for the topics
<RoundedButtonForTopic@Button>
    background_color:(0,0,0,0)
    background_normal: ''
    # canvas is a container for instructions. Use canvas.before to add instructions rendered before with self. 
    canvas.before:
        Color:
            rgba: (76/255,92/255,165/255,0.8)
        RoundedRectangle:
            size: self.size
            pos: self.pos
            # change radius to change roundness of the button
            radius: [48]

# Toggle for Music
<Toggle@Button>
    background_color: (0, 0, 0, 0)
    background_normal: ''
    canvas.before:
        Color:
            rgba: (255, 255, 255, 1)
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [100]

# make other screens
<Elementary>:
    # screen for elementary math 
    name: "elementary"

    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height
        padding: "30dp"
        spacing: "10dp"
    
        Button:
            text: "Go Back"
            pos_hint: {'left': 1, 'top': 1}
            size_hint: (0.22,0.22)
            font_size: 14
            on_release: 
                app.root.current = "mathLevel"
                root.manager.transition.direction = "right"
                root.play_button_sound()

        RoundedButtonForTopic:
            text: "Order of Operations"
            font_size: 20
            #connect this button to card layout 
            on_release:
                app.root.current = "ProblemCards"
                app.root.current_screen.reload('Order of Operations')
                root.manager.transition.direction = "left"
                root.play_button_sound()

        ProgressBar:
            id: pemdasProgressBar
            min: 0
            max: 1
            size_hint_x: 0.8
            size_hint_y: 0.05
            pos_hint: {"center_x": 0.5}  # center horizontally
        
        Label:
            id: pemdasLabel
            text: "0%"
            size_hint_y: 0.05 
            color: 0, 0, 0, 1
            halign: 'right'
            padding: 35,0
            text_size: self.width, None

        RoundedButtonForTopic:
            text: "Perimeters and Areas of Polygons"
            font_size: 20
            #connect this button to card layout 
            on_release:
                app.root.current = "ProblemCards"
                #app.root.current_screen.reload('Perimeters and Areas of Polygons')
                root.manager.transition.direction = "left"
                root.play_button_sound()
            on_press:
                app.root.get_screen("elementary").update_progressBar("roundNumProgressBar", "roundNumLabel")
        
        ProgressBar:
            id: roundNumProgressBar
            min: 0
            max: 1
            size_hint_x: 0.8
            size_hint_y: 0.1 
            pos_hint: {"center_x": 0.5}  # center horizontally
        
        Label:
            id: roundNumLabel
            text: "0%"
            size_hint_y: 0.05 
            color: 0, 0, 0, 1
            halign: 'right'
            padding: 35,0
            text_size: self.width, None

<MiddleSchool>:
    # screen for middle school math 
    name: "middleSchool"

    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height
        padding: "30dp"
        spacing: "10dp"
    
        Button:
            text: "Go Back"
            pos_hint: {'left': 1, 'top': 1}
            size_hint: (0.22,0.22)
            font_size: 14
            on_release: 
                app.root.current = "mathLevel"
                root.manager.transition.direction = "right"
                root.play_button_sound()

        RoundedButtonForTopic:
            text: "Fractions"
            font_size: 20
            #connect this button to card layout 
            on_release:
                app.root.current = "ProblemCards"
                app.root.current_screen.reload('Fractions')
                root.manager.transition.direction = "left"
                root.play_button_sound()
        
        ProgressBar:
            id: fractionProgressBar
            min: 0
            max: 1
            size_hint_x: 0.8
            size_hint_y: 0.1 
            pos_hint: {"center_x": 0.5}  # center horizontally
        
        Label:
            id: fractionLabel
            text: "0%"
            size_hint_y: 0.05 
            color: 0, 0, 0, 1
            halign: 'right'
            padding: 35,0
            text_size: self.width, None

        RoundedButtonForTopic:
            text: "Solving Equations With\nOne Unknown"
            font_size: 20
            #connect this button to card layout 
            on_release:
                app.root.current = "ProblemCards"
                #app.root.current_screen.reload('Solving Equations With\nOne Unknown')
                root.manager.transition.direction = "left"
                root.play_button_sound()
            # updates Progress Bar when button is pressed 
            on_press:
                app.root.get_screen("middleSchool").update_progressBar("oneUnknownProgressBar", "oneUnknownLabel")
        
        ProgressBar:
            id: oneUnknownProgressBar
            min: 0
            max: 1
            size_hint_x: 0.8
            size_hint_y: 0.1 
            pos_hint: {"center_x": 0.5}  # center horizontally
        
        Label:
            id: oneUnknownLabel
            text: "0%"
            size_hint_y: 0.05 
            color: 0, 0, 0, 1
            halign: 'right'
            padding: 35,0
            text_size: self.width, None

<HighSchool>:
    # screen for high school math 
    name: "highSchool"

    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height
        padding: "30dp"
        spacing: "10dp"
    
        Button:
            text: "Go Back"
            pos_hint: {'left': 1, 'top': 1}
            size_hint: (0.22,0.22)
            font_size: 14
            on_release: 
                app.root.current = "mathLevel"
                root.manager.transition.direction = "right"
                root.play_button_sound()

        RoundedButtonForTopic:
            text: "Quadratic Equations\nwith Real Solutions"
            font_size: 20
            #connect this button to card layout 
            on_release:
                app.root.current = "ProblemCards"
                app.root.current_screen.reload('Quadratics')
                root.manager.transition.direction = "left"
                root.play_button_sound()
        
        ProgressBar:
            id: quadraticProgressBar
            min: 0
            max: 1
            size_hint_x: 0.8
            size_hint_y: 0.1 
            pos_hint: {"center_x": 0.5}  # center horizontally
        
        Label:
            id: quadraticLabel
            text: "0%"
            size_hint_y: 0.05 
            color: 0, 0, 0, 1
            halign: 'right'
            padding: 35,0
            text_size: self.width, None

        RoundedButtonForTopic:
            text: "Logarithms"
            font_size: 20
            #connect this button to card layout 
            on_release:
                app.root.current = "ProblemCards"
                #app.root.current_screen.reload('Logarithms')
                root.manager.transition.direction = "left"
                root.play_button_sound()
            # updates Progress Bar when button is pressed 
            on_press:
                app.root.get_screen("highSchool").update_progressBar("logProgressBar", "logLabel")
        
        ProgressBar:
            id: logProgressBar
            min: 0
            max: 1
            size_hint_x: 0.8
            size_hint_y: 0.1 
            pos_hint: {"center_x": 0.5}  # center horizontally
        
        Label:
            id: logLabel
            text: "0%"
            size_hint_y: 0.05 
            color: 0, 0, 0, 1
            halign: 'right'
            padding: 35,0
            text_size: self.width, None

<College>:
    # screen for college math 
    name: "college"

    BoxLayout:
        orientation: "vertical"
        size: root.width, root.height
        padding: "30dp"
        spacing: "10dp"
    
        Button:
            text: "Go Back"
            pos_hint: {'left': 1, 'top': 1}
            size_hint: (0.22,0.22)
            font_size: 14
            on_release: 
                app.root.current = "mathLevel"
                root.manager.transition.direction = "right"
                root.play_button_sound()

        RoundedButtonForTopic:
            text: "Derivatives"
            font_size: 20
            #connect this button to card layout 
            on_release:
                app.root.current = "ProblemCards"
                app.root.current_screen.reload('Derivatives')
                root.manager.transition.direction = "left"
                root.play_button_sound()
        
        ProgressBar:
            id: derivativesProgressBar
            min: 0
            max: 1
            size_hint_x: 0.8
            size_hint_y: 0.1 
            pos_hint: {"center_x": 0.5}  # center horizontally
        
        Label:
            id: derivativesLabel
            text: "0%"
            size_hint_y: 0.05 
            color: 0, 0, 0, 1
            halign: 'right'
            padding: 35,0
            text_size: self.width, None

        RoundedButtonForTopic:
            text: "Integrals"
            font_size: 20
            #connect this button to card layout 
            on_release:
                app.root.current = "ProblemCards"
                #app.root.current_screen.reload('Integrals')
                root.manager.transition.direction = "left"
                root.play_button_sound()
            # updates Progress Bar when button is pressed 
            on_press:
                app.root.get_screen("college").update_progressBar("integralsProgressBar", "integralsLabel")
        
        ProgressBar:
            id: integralsProgressBar
            min: 0
            max: 1
            size_hint_x: 0.8
            size_hint_y: 0.1 
            pos_hint: {"center_x": 0.5}  # center horizontally
        
        Label:
            id: integralsLabel
            text: "0%"
            size_hint_y: 0.05 
            color: 0, 0, 0, 1
            halign: 'right'
            padding: 35,0
            text_size: self.width, None